<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>BA - é”€å”®å®æˆ˜é©¾é©¶èˆ± v8.0</title>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --ba-green: #3aae36; --ba-dark: #1e293b; --ba-light-green: #e8f5e9; --border: #e2e8f0; }
        body { font-family: 'Outfit', 'PingFang SC', sans-serif; background: #f8fafc; margin: 0; display: flex; height: 100vh; color: #334155; }
        
        /* å·¦ä¾§ï¼šç²¾ç¾æ¡£æ¡ˆå¡ */
        .sidebar { width: 380px; background: white; border-right: 1px solid var(--border); display: flex; flex-direction: column; padding: 0; box-shadow: 10px 0 15px rgba(0,0,0,0.02); }
        .sidebar-header { padding: 30px; background: var(--ba-dark); color: white; text-align: center; }
        .sidebar-header img { width: 140px; margin-bottom: 10px; }
        
        .crm-data-card { padding: 25px; flex: 1; overflow-y: auto; }
        .data-group { background: #f1f5f9; border-radius: 12px; padding: 15px; margin-bottom: 20px; border: 1px solid var(--border); }
        .data-label { font-size: 11px; color: #64748b; font-weight: 700; text-transform: uppercase; margin-bottom: 8px; display: block; }
        .data-value { font-size: 16px; font-weight: 600; color: var(--ba-dark); word-break: break-all; }
        
        .insight-tags { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; }
        .tag-pill { background: var(--ba-green); color: white; padding: 4px 12px; border-radius: 50px; font-size: 12px; font-weight: 500; }

        .sidebar-footer { padding: 20px; border-top: 1px solid var(--border); }
        .btn-xl { background: var(--ba-green); color: white; border: none; padding: 14px; border-radius: 10px; width: 100%; cursor: pointer; font-size: 15px; font-weight: 700; display: flex; align-items: center; justify-content: center; gap: 10px; transition: 0.2s; }
        .btn-xl:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(58,174,54,0.3); }

        /* å³ä¾§ï¼šå¯¹è¯ä¸»èˆå° */
        .main { flex: 1; display: flex; flex-direction: column; }
        .top-status { height: 70px; background: white; border-bottom: 1px solid var(--border); display: flex; align-items: center; padding: 0 30px; justify-content: space-between; }
        .status-indicator { display: flex; gap: 40px; }
        .status-item b { color: var(--ba-green); font-size: 18px; }

        #chat-area { flex: 1; padding: 30px; overflow-y: auto; display: flex; flex-direction: column; gap: 20px; background-image: radial-gradient(#e2e8f0 1px, transparent 1px); background-size: 20px 20px; }
        .bubble { max-width: 70%; padding: 16px 20px; border-radius: 20px; font-size: 15px; line-height: 1.6; position: relative; }
        .bubble.dr { background: white; align-self: flex-start; border: 1px solid var(--border); border-bottom-left-radius: 2px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); }
        .bubble.me { background: var(--ba-green); color: white; align-self: flex-end; border-bottom-right-radius: 2px; }

        .options-tray { background: white; padding: 30px; border-top: 1px solid var(--border); }
        .option-card { border: 1px solid var(--border); padding: 18px; border-radius: 12px; margin-bottom: 12px; cursor: pointer; transition: 0.2s; font-size: 14px; display: flex; align-items: center; justify-content: space-between; }
        .option-card:hover { border-color: var(--ba-green); background: var(--ba-light-green); }
        .option-card::after { content: "â”"; color: var(--ba-green); font-weight: bold; }

        /* åˆå§‹é®ç½© */
        #welcome { position: absolute; inset: 0; background: white; z-index: 50; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 40px; text-align: center; }
        .input-box { width: 350px; padding: 15px; border: 2px solid #e2e8f0; border-radius: 12px; margin-bottom: 20px; font-size: 16px; outline: none; text-align: center; }
        .input-box:focus { border-color: var(--ba-green); }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="sidebar-header">
            <img src="https://bostonaesthetics.com.design.com.mk/en-US/wp-content/uploads/2024/12/BA-Logo-256.png">
            <div style="font-size: 12px; opacity: 0.8;">Smart Sales CRM System</div>
        </div>

        <div class="crm-data-card">
            <div class="section-title" style="font-weight:700; margin-bottom:15px">å®¢æˆ·æ¡£æ¡ˆæ•°æ®</div>
            
            <div class="data-group">
                <span class="data-label">å®¢æˆ·å§“å (Name)</span>
                <div class="data-value" id="disp-name">æœªå½•å…¥</div>
            </div>

            <div class="data-group">
                <span class="data-label">è”ç³»ç”µè¯ (Contact)</span>
                <div class="data-value" id="disp-phone">æœªå½•å…¥</div>
            </div>

            <div class="data-group">
                <span class="data-label">å®æ—¶æ´å¯Ÿæ ‡ç­¾ (Insights Tags)</span>
                <div class="insight-tags" id="disp-tags">
                    <span style="color:#94a3b8; font-size:13px">ç­‰å¾…æ‹œè®¿ç”Ÿæˆ...</span>
                </div>
            </div>
        </div>

        <div class="sidebar-footer">
            <button class="btn-xl" onclick="exportToExcel()">
                <span>ğŸ“„ å¯¼å‡ºæŠ¥è¡¨ (Excel)</span>
            </button>
        </div>
    </div>

    <div class="main">
        <div id="welcome">
            <h1 style="margin-bottom:10px">æ–°å®¢æˆ·è®¿è°ˆ</h1>
            <p style="color:#64748b; margin-bottom:40px">ç³»ç»Ÿå°†ä»10ä¸ªå®æˆ˜é¢˜åº“ä¸­éšæœºæŠ½å–3ä¸ªæŒ‘æˆ˜</p>
            <input type="text" id="in-name" class="input-box" placeholder="å®¢æˆ·å§“å">
            <input type="text" id="in-phone" class="input-box" placeholder="è”ç³»ç”µè¯">
            <button class="btn-xl" style="width: 350px;" onclick="startVisit()">è¿›å…¥è®¿è°ˆé©¾é©¶èˆ±</button>
        </div>

        <div class="top-status">
            <div style="font-weight: 700;">BA å®æˆ˜åŠ©ç† v8.0 (éšæœºé¢˜åº“ç‰ˆ)</div>
            <div class="status-indicator">
                <div class="status-item">æˆäº¤æ„å‘: <b id="stat-win">0%</b></div>
                <div class="status-item">åˆè§„å®‰å…¨: <b id="stat-risk" style="color:var(--ba-green)">SAFE</b></div>
            </div>
        </div>

        <div id="chat-area"></div>

        <div class="options-tray" id="tray">
            <div style="font-size: 11px; color:#94a3b8; margin-bottom:15px; font-weight:700; text-transform:uppercase">Suggested Strategies</div>
            <div id="options-list"></div>
        </div>
    </div>

<script>
    let visitData = { name: "", phone: "", tags: [], logs: [], win: 0, risk: 0 };
    
    // æ‰©å……è‡³ 10 ä¸ªé—®é¢˜çš„é¢˜åº“
    const fullPool = [
        { q: "åŠå²›è¶…å£°ç‚®ç°åœ¨å¸‚åœºä¸Šé£å¾ˆå¤§ï¼Œä½†æœ‹å‹åœˆå…¨æ˜¯ä½ä»·å¼•æµã€‚æˆ‘è¿™ä¸€å°æœºå™¨å–è¿™ä¹ˆè´µï¼Œæ€ä¹ˆè·Ÿè·¯è¾¹åº—ç«äº‰ï¼Ÿ", opts: [
        { t: "â€œä¸»ä»»ï¼Œå’±ä»¬æ˜¯æ­£è§„æœºæ„ã€‚æˆ‘ä»¬å»ºè®®ä¸»æ‰“â€˜å››ç‚¹éªŒè¯â€™æ‰«ç é˜²ä¼ªå’Œæ‚¨çš„ä¸“ä¸šæ“ä½œï¼Œç”¨åŒ»ç–—æ ‡å‡†å¯¹æ ‡ç”Ÿæ´»ç¾å®¹ã€‚â€", tag: "å“ç‰Œä»·å€¼æ´¾", win: 15, risk: 0 },
        { t: "â€œä»·æ ¼æˆ‘ä»¬å¯ä»¥é€šè¿‡å¢åŠ ç–—ç¨‹èµ å“æ¥å¹³è¡¡ï¼Œæˆ–è€…é’ˆå¯¹ç†Ÿå®¢åšå†…éƒ¨ç‰¹ä»·æ–¹æ¡ˆã€‚â€", tag: "ä»·æ ¼é˜²å¾¡æ´¾", win: 10, risk: 10 }
    ]},
    { q: "éš”å£è¯Šæ‰€ä¹°çš„çš®ç§’æ˜¯â€˜æ°´è´§â€™ã€‚æˆ‘ä¹°åŠå²›çš„é»„é‡‘å¾®é’ˆï¼Œèƒ½ä¿è¯åœ¨è¿™ä¸ªç‰‡åŒºç»™æˆ‘â€˜ç‹¬å®¶æˆæƒâ€™å—ï¼Ÿ", opts: [
        { t: "â€œç‹¬å®¶æˆæƒæ¶‰åŠæ³•å¾‹åˆè§„ã€‚ä½†æˆ‘ä»¬å¯ä»¥ä¸ºæ‚¨é¢å‘â€˜ä¸´åºŠç¤ºèŒƒä¸­å¿ƒâ€™é“­ç‰Œï¼Œå¹¶åœ¨å®˜æ–¹åœ°å›¾ä¸Šæ ‡æ³¨æ‚¨çš„æœºæ„ã€‚â€", tag: "åˆè§„å‡†å…¥æ´¾", win: 12, risk: -5 },
        { t: "â€œåªè¦æ‚¨æ‹¿è´§é‡è¾¾æ ‡ï¼Œæˆ‘å¯ä»¥å£å¤´ä¿è¯åŠå¹´å†…ä¸ç»™æ‚¨æ–¹åœ†3å…¬é‡Œçš„åŒè¡Œä¾›è´§ã€‚â€", tag: "å£å¤´æ‰¿è¯ºæ´¾", win: 18, risk: 30 }
    ]},
    { q: "é»„é‡‘å¾®é’ˆçš„æ“ä½œå¤´æ˜¯è€—æå§ï¼Ÿä¸ºäº†ç»™æ‚£è€…çœé’±ï¼Œæˆ‘ç”¨é…’ç²¾æ¶ˆæ¯’åé‡å¤ä½¿ç”¨ï¼Œä¼šæœ‰é£é™©å—ï¼Ÿ", opts: [
        { t: "â€œåšå†³ä¸å¯ï¼é’ˆå¤´æ¶‚å±‚æŸåä¼šå¼•èµ·è¡¨çš®çƒ«ä¼¤ï¼Œä¸”æ— æ³•ä¿è¯æ— èŒã€‚åŠå²›åšæŒâ€˜ä¸€äººä¸€å¤´â€™æ˜¯åº•çº¿ã€‚â€", tag: "ä¸´åºŠä¸¥è°¨å‹", win: 10, risk: -20 },
        { t: "â€œå»ºè®®å°½é‡è¿˜æ˜¯æ¢æ–°çš„ã€‚å¦‚æœä¸€å®šè¦å¤ç”¨ï¼Œåªèƒ½é’ˆå¯¹åŒä¸€ä¸ªæ‚£è€…ï¼Œä½†æˆ‘ä»¬ä¸æ¨èè¿™æ ·åšã€‚â€", tag: "é£é™©é»˜è®¤å‹", win: 5, risk: 50 }
    ]},
    { q: "éƒ½è¯´è¶…å£°ç‚®æ˜¯â€˜å›½äº§ä¹‹å…‰â€™ï¼Œä½†å‚æ•°æ¯”è¿›å£çš„è¶…å£°åˆ€å¼±ï¼Œåˆ°åº•èƒ½ä¸èƒ½è¾¾åˆ°æ·±å±‚ææ‹‰çš„æ•ˆæœï¼Ÿ", opts: [
        { t: "â€œè¶…å£°ç‚®é‡‡ç”¨çš„æ˜¯â€˜å¤§ç„¦åŸŸâ€™æŠ€æœ¯ï¼Œåœ¨ä¿è¯æ·±åº¦çš„åŒæ—¶å¤§å¤§é™ä½äº†ç—›æ„Ÿï¼Œæ›´é€‚åˆä¸­å›½äººçš„é¢éƒ¨ç»“æ„ã€‚â€", tag: "æŠ€æœ¯è§£æ„å‹", win: 20, risk: 0 },
        { t: "â€œå‚æ•°è™½ç„¶ç•¥ä½ï¼Œä½†æˆ‘ä»¬æ“ä½œæ¬¡æ•°å¤šï¼Œå åŠ æ•ˆåº”ä¸‹æ•ˆæœä¸è¾“è¿›å£æœºå™¨ã€‚â€", tag: "ç»éªŒæ›¿ä»£å‹", win: 10, risk: 5 }
    ]},
    { q: "æˆ‘æƒ³åœ¨ç›´æ’­é—´å®£ä¼ â€˜ä¸€æ¬¡å³åˆ»å¹´è½»5å²â€™ï¼Œé…ä¸Šè¶…å£°ç‚®çš„Logoï¼Œä½ ä»¬å‚å®¶æ”¯æŒè¿™ç§å®£ä¼ å—ï¼Ÿ", opts: [
        { t: "â€œåŒ»ç–—å¹¿å‘Šç¦æ­¢æ‰¿è¯ºç–—æ•ˆã€‚å»ºè®®å®£ä¼ â€˜é¢éƒ¨è½®å»“ç²¾é›•â€™ï¼Œå¹¶ä½¿ç”¨å®˜æ–¹è®¤è¯çš„åˆè§„æ¨¡ç‰¹ç´ æã€‚â€", tag: "ç¨³å¥åˆè§„å‹", win: 15, risk: 0 },
        { t: "â€œåªè¦ä¸ç‚¹åå…·ä½“çš„â€˜5å²â€™ï¼Œæ¨¡ç³Šä¸€ç‚¹è¯´â€˜é€†é¾„ç¥å™¨â€™æ˜¯å¯ä»¥å°è¯•çš„ã€‚â€", tag: "è¥é”€è¾¹ç¼˜å‹", win: 18, risk: 40 }
    ]},
    { q: "åŠå²›çš„ç§å¯†è¶…å£°åˆ€ï¼ˆç§å¯†ç‚®ï¼‰ç°åœ¨æ‹¿åˆ°äº†ä¸‰ç±»åŒ»ç–—å™¨æ¢°è¯å—ï¼Ÿé™¢é‡Œå¯¹è¯ä»¶æŠ“å¾—å¾ˆæ­»ã€‚", opts: [
        { t: "â€œåŠå²›ä¸€ç›´èµ°åˆè§„è·¯çº¿ï¼Œç›¸å…³å‹å·å‡æœ‰æ˜ç¡®çš„å‡†å…¥è¯ä»¶ã€‚è¿™æ˜¯å…¨å¥—æ³¨å†Œè¯å¤å°ä»¶ï¼Œè¯·æ‚¨å®¡é˜…ã€‚â€", tag: "æ­£è§„å†›å‹", win: 20, risk: 0 },
        { t: "â€œç›®å‰è¯ä»¶åœ¨æµç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆä»¥â€˜çš®è‚¤ç§‘é¡¹ç›®â€™çš„åä¹‰è¿›å…¥ï¼Œè¯ä»¶å¾ˆå¿«å°±ä¸‹æ¥ã€‚â€", tag: "è¿è§„å‡†å…¥å‹", win: 0, risk: 60 }
    ]},
    { q: "é»„é‡‘å¾®é’ˆ4.0çš„è´Ÿå‹å¤´ï¼Œæ‚£è€…åé¦ˆå¸åŠ›å¤ªå¤§ä¼šäº§ç”Ÿç˜€æ–‘ï¼Œæˆ‘èƒ½ä¸èƒ½ç›´æ¥å…³æ‰è´Ÿå‹æ“ä½œï¼Ÿ", opts: [
        { t: "â€œè´Ÿå‹æ˜¯ä¸ºäº†ä¿è¯å‡ºé’ˆå‡åŒ€ã€‚å¦‚æœäº§ç”Ÿç˜€æ–‘ï¼Œå»ºè®®è°ƒæ•´è´Ÿå‹ç­‰çº§è€Œéç›´æ¥å…³é—­ï¼Œæˆ‘ä¼šæ¥ååŠ©æ‚¨è°ƒæœºã€‚â€", tag: "ä¸“ä¸šæœåŠ¡å‹", win: 15, risk: 0 },
        { t: "â€œå…³æ‰ä¹Ÿå¯ä»¥ï¼Œä¸è¿‡å‡ºé’ˆæ·±åº¦å°±æ²¡é‚£ä¹ˆå‡†äº†ï¼Œæ‚¨å¯ä»¥æ ¹æ®æ‰‹æ„Ÿè‡ªå·±æŒæ¡ã€‚â€", tag: "éšæ„æ“ä½œå‹", win: 5, risk: 30 }
    ]},
    { q: "è¶…å£°ç‚®çš„ç‚®å¤´å’Œåˆ€å¤´ï¼Œä¸€ä¸ªç–—ç¨‹ä¸‹æ¥æˆæœ¬å¤ªé«˜äº†ã€‚èƒ½ä¸èƒ½ç»™ç‚¹æŠ˜æ‰£ï¼Ÿ", opts: [
        { t: "â€œè€—æä»·æ ¼æ˜¯å…¨å›½ç»Ÿä¸€çš„ã€‚ä½†æˆ‘å¯ä»¥å¸®æ‚¨ç”³è¯·æ›´å¤šçš„é™¢å†…å®£æ•™æ”¯æŒæˆ–æœ¯åä¿®å¤è€—æèµ é€ã€‚â€", tag: "ä»·å€¼è½¬æ¢å‹", win: 12, risk: 5 },
        { t: "â€œå¦‚æœæ‚¨è¿™æ¬¡èƒ½è®¢100ä¸ªå¤´ï¼Œæˆ‘å¯ä»¥ç§ä¸‹è·Ÿä»£ç†å•†è°ˆï¼Œè¿”æ‚¨å‡ ä¸ªç‚¹ã€‚â€", tag: "åˆ©ç›Šé©±åŠ¨å‹", win: 20, risk: 40 }
    ]},
    { q: "åŠå²›çš„æœºå™¨æ•…éšœç‡å¥½åƒæ¯”è¿›å£çš„é«˜ï¼Ÿä¸‡ä¸€æœºå™¨åœ¨æ“ä½œä¸­çªç„¶æ­»æœºçƒ§ä¼¤æ‚£è€…æ€ä¹ˆåŠï¼Ÿ", opts: [
        { t: "â€œåŠå²›æœ‰ä¸‰é‡å®‰å…¨è‡ªæ£€ç³»ç»Ÿï¼Œç¬æ—¶æ–­ç”µä¿æŠ¤ã€‚ä¸”æˆ‘ä»¬åœ¨æœ¬å¸‚æœ‰24å°æ—¶å·¥ç¨‹å¸ˆä¸Šé—¨æœåŠ¡ã€‚â€", tag: "ä¿éšœå®Œå–„å‹", win: 15, risk: 0 }
        ]}
    ];

    let scriptPool = []; // ç”¨äºå­˜æ”¾æœ¬æ¬¡éšæœºæŠ½å–çš„3é¢˜
    let currentStep = 0;

    function startVisit() {
        const n = document.getElementById('in-name').value;
        const p = document.getElementById('in-phone').value;
        if(!n || !p) return alert("è¯·å®Œæ•´å¡«å†™ä¿¡æ¯");
        
        visitData.name = n;
        visitData.phone = p;
        document.getElementById('disp-name').innerText = n;
        document.getElementById('disp-phone').innerText = p;
        document.getElementById('welcome').style.display = 'none';
        
        // éšæœºæŠ½å– 3 é¢˜é€»è¾‘
        scriptPool = fullPool.sort(() => 0.5 - Math.random()).slice(0, 3);
        
        renderStep();
    }

    function renderStep() {
        if(currentStep >= scriptPool.length) {
            addBubble("æ‹œè®¿ç»“æŸã€‚æ•°æ®å·²åŒæ­¥ï¼Œå¯å¯¼å‡º Excel æŠ¥è¡¨ã€‚", "dr");
            document.getElementById('options-list').innerHTML = "<b>æ‹œè®¿å·²å®Œæˆï¼Œè¯·å¯¼å‡ºæŠ¥è¡¨ã€‚</b>";
            return;
        }
        const data = scriptPool[currentStep];
        addBubble(data.q, "dr");
        
        const list = document.getElementById('options-list');
        list.innerHTML = "";
        data.opts.forEach(o => {
            const btn = document.createElement('div');
            btn.className = "option-card";
            btn.innerText = o.t;
            btn.onclick = () => {
                addBubble(o.t, "me");
                updateStats(o);
                currentStep++;
                setTimeout(renderStep, 800);
            };
            list.appendChild(btn);
        });
    }

    function addBubble(txt, role) {
        const box = document.getElementById('chat-area');
        const b = document.createElement('div');
        b.className = `bubble ${role}`;
        b.innerText = txt;
        box.appendChild(b);
        box.scrollTop = box.scrollHeight;
    }

    function updateStats(o) {
        visitData.win += o.win;
        visitData.risk += o.risk;
        visitData.tags.push(o.tag);
        visitData.logs.push(`åŒ»: ${scriptPool[currentStep].q} | é”€: ${o.t}`);
        
        document.getElementById('stat-win').innerText = Math.max(0, visitData.win) + "%";
        const r = document.getElementById('stat-risk');
        if(visitData.risk > 30) { 
            r.innerText = "WARNING"; 
            r.style.color = "red"; 
        } else {
            r.innerText = "SAFE";
            r.style.color = "var(--ba-green)";
        }
        
        const tagBox = document.getElementById('disp-tags');
        if(currentStep === 0) tagBox.innerHTML = "";
        const span = document.createElement('span');
        span.className = "tag-pill";
        span.innerText = o.tag;
        tagBox.appendChild(span);
    }

    function exportToExcel() {
        if(!visitData.name) return alert("æ— æ•°æ®");
        const rows = [
            ["Boston Aesthetics æ‹œè®¿æŠ¥å‘Š", ""],
            ["å®¢æˆ·å§“å", visitData.name],
            ["è”ç³»ç”µè¯", visitData.phone],
            ["æœ€ç»ˆæ„å‘", visitData.win + "%"],
            ["æ ‡ç­¾åˆ†æ", visitData.tags.join(", ")],
            ["", ""],
            ["å¯¹è¯æµæ°´", ""]
        ];
        visitData.logs.forEach((l, i) => rows.push([`åœºæ™¯ ${i+1}`, l]));
        
        const ws = XLSX.utils.aoa_to_sheet(rows);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "æ‹œè®¿è®°å½•");
        XLSX.writeFile(wb, `BA_CRM_${visitData.name}.xlsx`);
    }
</script>

</body>
</html>